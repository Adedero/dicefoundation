import{_ as P}from"./VPage.vue_vue_type_script_setup_true_lang-D3aXKuuB.js";import{s as T}from"./index-DZtLgP2Y.js";import{s as q}from"./index-CZEEhluR.js";import{_ as z}from"./FileUploader.vue_vue_type_script_setup_true_lang-CZWotbSj.js";import{d as D,aU as G,u as H,v as J,h as K,r as i,i as L,c as $,w as k,a as s,b as U,k as h,l as v,j as o,aV as O,s as Q,q as W,o as u,m as X,n as Y}from"./index-BernQVxA.js";import{$ as C,_ as Z}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-sh5mCXpp.js";import"./index-CvyUCB5w.js";import"./index-CDuATX9l.js";const ee={class:"flex items-center justify-end gap-3"},ae={key:1},se={class:"grid gap-4 md:grid-cols-3"},te={class:"border rounded-md p-4 flex flex-col gap-2 items-center justify-center"},le={class:"w-32 aspect-square overflow-hidden rounded-full bg-neutral-200 dark:bg-neutral-800"},oe={key:0,class:"mt-3 w-full"},ne={class:"lg:col-span-2 grid gap-5 lg:grid-cols-2"},re={class:"flex flex-col gap-1"},ie={class:"flex flex-col gap-1"},de={class:"lg:col-span-2 flex flex-col gap-1"},ye=D({__name:"Account",async setup(ue){var V;let d,p;const f=J(),_=G(),g=H(),x=f.params.id?f.params.id.toString():_.user.id,{data:j,error:m,execute:B}=([d,p]=K(()=>C(`users/${x}`).json()),d=await d,p(),d),a=i(j.value),N=i(((V=a.value)==null?void 0:V.image)??""),n=i(),r=i(!1),c=i(),y=async()=>{if(!a.value)return;delete a.value.password,n.value&&(a.value.password=n.value),X(r,c);const{data:t,error:e}=await C(`users/${x}`).put({data:a.value}).json();if(Y(r,c,e),c.value){g.add({severity:"error",summary:"Error",detail:m.value.message,life:6e3});return}t.value&&(g.add({severity:"success",summary:"Updated",life:3e3}),_.setUser({name:t.value.name,email:t.value.email,image:t.value.image||void 0}))},S=L(()=>{var t,e;return!((t=a.value)!=null&&t.name)||!((e=a.value)!=null&&e.email)||n.value&&n.value.length<6}),A=t=>{const e=t[0];a.value.image=e.dataUrl};return(t,e)=>{const w=Q,E=Z,M=O,R=z,b=q,F=T,I=P;return u(),$(I,{header:"Account"},{actions:k(()=>[s("div",ee,[o(w,{onClick:y,loading:r.value,disabled:S.value||r.value,label:"Save",icon:"pi pi-save"},null,8,["loading","disabled"])])]),default:k(()=>[s("div",null,[v(m)?(u(),$(E,{key:0,error:v(m),"should-retry":"",onRetry:v(B)},null,8,["error","onRetry"])):a.value?(u(),U("div",ae,[s("div",se,[s("div",te,[s("div",le,[o(M,{image:a.value.image,rounded:"",size:"8rem"},null,8,["image"])]),o(R,{onSelect:A,onUpload:y,onCancel:e[0]||(e[0]=l=>a.value.image=N.value),"max-file-size":1024*1024*1,class:"w-full mt-2",loading:r.value},null,8,["loading"]),a.value.image?(u(),U("div",oe,[o(w,{onClick:e[1]||(e[1]=l=>a.value.image=""),label:"Remove",severity:"secondary",icon:"pi pi-times-circle",fluid:""})])):h("",!0)]),s("div",ne,[s("div",re,[e[5]||(e[5]=s("label",{class:"text-sm font-medium"},"Name",-1)),o(b,{modelValue:a.value.name,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.name=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"])]),s("div",ie,[e[6]||(e[6]=s("label",{class:"text-sm font-medium"},[W(" Password "),s("span",{class:"text-xs"},"(must have at least 6 characters)")],-1)),o(F,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value=l),modelModifiers:{trim:!0},"toggle-mask":"",fluid:""},null,8,["modelValue"])]),s("div",de,[e[7]||(e[7]=s("label",{class:"text-sm font-medium"},"Email",-1)),o(b,{modelValue:a.value.email,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.email=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"])])])])])):h("",!0)])]),_:1})}}});export{ye as default};

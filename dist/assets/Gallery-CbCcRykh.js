import{_ as N}from"./VPage.vue_vue_type_script_setup_true_lang-D3aXKuuB.js";import{d as C,u as V,r as h,aF as G,b as p,H as B,j as i,s as D,o as n,m as I,n as U,a as r,aG as P,w as x,k,h as S,c as F,l as _,F as q,e as A,t as M}from"./index-BernQVxA.js";import{$ as j,_ as z}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-sh5mCXpp.js";import{s as R}from"./index-DHJ_47cS.js";import{_ as H}from"./FileUploader.vue_vue_type_script_setup_true_lang-CZWotbSj.js";import"./index-CvyUCB5w.js";const L=C({__name:"ImageDeleter",props:{id:{}},emits:["delete"],setup($,{emit:c}){const f=V(),e=c,t=h(!1),o=h();async function l(){I(t,o);const{data:m,error:a}=await j(`gallery/${$.id}`).delete().json();U(t,o,a),a.value&&f.add({severity:"error",summary:"Error",detail:a.value.message,life:3e3}),m.value&&e("delete",$.id)}const v=G(),u=()=>{v.require({header:"Delete file",message:"Are you sure you want to delete this file?",rejectProps:{severity:"secondary",icon:"pi pi-times",label:"Cancel"},acceptProps:{severity:"danger",icon:"pi pi-trash",label:"Delete"},accept:()=>{l()}})};return(m,a)=>{const s=D;return n(),p("div",{onClick:u,class:"cursor-pointer w-full"},[B(m.$slots,"default",{loading:t.value},()=>[i(s,{label:"Delete",icon:"pi pi-trash",severity:"danger"})])])}}}),T={key:0,class:"mb-4"},J={key:1,class:"flex items-center justify-center mb-5"},K={class:"w-full aspect-square rounded-md overflow-hidden bg-zinc-200 dark:bg-zinc-600"},O=["src"],Q=C({__name:"ImageCreator",emits:["create"],setup($,{emit:c}){const f=c,e=h(!1),t=h(),o=h(!1),l=h();async function v(a){const s=a[0];delete s.dataUrl,I(o,l);const g=new FormData;g.append("file",s);const{data:y,error:w}=await j("gallery").post(g).json();U(o,l,w),y.value&&(t.value=y.value,f("create",t.value),e.value=!1)}function u(a){t.value={name:a[0].name,url:a[0].dataUrl??""}}function m(){t.value=void 0,e.value=!1,l.value=void 0,o.value=!1}return(a,s)=>{const g=D,y=z,w=H,d=P;return n(),p("div",null,[r("div",{onClick:s[0]||(s[0]=b=>e.value=!0),class:"cursor-pointer"},[B(a.$slots,"default",{},()=>[i(g,{label:"New",icon:"pi pi-plus"})])]),i(d,{visible:e.value,"onUpdate:visible":s[1]||(s[1]=b=>e.value=b),modal:"",header:"Upload Image",class:"w-80"},{default:x(()=>[l.value?(n(),p("div",T,[i(y,{error:l.value},null,8,["error"])])):k("",!0),t.value&&t.value.url?(n(),p("div",J,[r("div",K,[r("img",{src:t.value.url,class:"w-full h-full object-cover"},null,8,O)])])):k("",!0),r("div",null,[i(w,{loading:o.value,onCancel:m,onSelect:u,onUpload:v,"max-file-size":1024*1024*10,accept:"image/*"},null,8,["loading"])])]),_:1},8,["visible"])])}}}),W={class:"flex justify-end"},X={key:1,class:"grid gap-5 grid-cols-[repeat(auto-fill,minmax(120px,1fr))]"},Y={class:"w-full h-48 bg-neutral-200 dark:bg-neutral-800 rounded-md overflow-hidden"},Z={class:"mt-2 w-full grid items-center gap-1 grid-cols-6 overflow-x-hidden"},ee={class:"col-span-4 truncate text-xs"},re=C({__name:"Gallery",async setup($){let c,f;const{data:e,error:t,execute:o}=([c,f]=S(()=>j("gallery").json()),c=await c,f(),c);function l(v){e.value&&(e.value=e.value.filter(u=>u.id!==v))}return(v,u)=>{const m=Q,a=z,s=R,g=D,y=L,w=N;return n(),F(w,{header:"Gallery"},{actions:x(()=>[r("div",W,[i(m,{onCreate:u[0]||(u[0]=d=>_(e)&&(e.value=[..._(e),d]))})])]),default:x(()=>[r("div",null,[_(t)?(n(),F(a,{key:0,error:_(t),"should-retry":"",onRetry:_(o)},null,8,["error","onRetry"])):_(e)?(n(),p("div",X,[(n(!0),p(q,null,A(_(e),(d,b)=>(n(),p("div",{key:d.id},[r("div",Y,[i(s,{src:d.url,preview:"",class:"h-full w-full","image-class":"w-full h-full object-cover"},null,8,["src"])]),r("div",Z,[r("p",ee,M(d.name||`Image ${b+1}`),1),i(y,{id:d.id,onDelete:l,class:"col-span-2"},{default:x(({loading:E})=>[i(g,{loading:E,icon:"pi pi-trash",size:"small",severity:"danger",text:""},null,8,["loading"])]),_:2},1032,["id"])])]))),128))])):k("",!0)])]),_:1})}}});export{re as default};

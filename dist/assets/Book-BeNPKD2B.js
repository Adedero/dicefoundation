import{_ as Q}from"./VPage.vue_vue_type_script_setup_true_lang-D3aXKuuB.js";import{s as W}from"./index-DHJ_47cS.js";import{_ as X}from"./ImagePicker.vue_vue_type_script_setup_true_lang-BJYwXjIX.js";import{s as Y}from"./index-CLVt6LG3.js";import{s as Z,_ as ee}from"./Deleter.vue_vue_type_script_setup_true_lang-DS0wtoW3.js";import{s as le}from"./index-CE-NW1yC.js";import{s as te}from"./index-ZguDolrA.js";import{s as se}from"./index-CZEEhluR.js";import{$ as y,_ as oe}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-sh5mCXpp.js";import{d as ae,u as ne,v as ue,r as m,h as ie,p as de,x as re,i as me,c as p,w as D,a as t,k as g,l as _,j as o,q as d,s as pe,b as j,e as fe,t as B,F as ve,o as r,m as ce,n as xe,y as ge}from"./index-BernQVxA.js";import"./index-CvyUCB5w.js";import"./index-CDuATX9l.js";const be={class:"flex justify-end gap-3"},Ve={class:"grid md:grid-cols-6 gap-5"},ke={class:"flex flex-col gap-1 md:col-span-2"},ye={class:"flex flex-col gap-1 md:col-span-2"},_e={class:"flex flex-col gap-1 md:col-span-2"},we={class:"flex flex-col gap-1 md:col-span-2"},Ue={class:"flex flex-col gap-1 md:col-span-2"},$e={class:"flex flex-col gap-1 md:col-span-2"},Ie={class:"flex flex-col gap-1 h-60 md:h-auto md:row-span-2 md:col-span-2 lg:col-span-2"},Le={class:"flex flex-col gap-1 h-60 md:h-auto md:row-span-2 md:col-span-2 lg:col-span-2"},Se={class:"flex flex-col gap-1 md:col-span-2"},Ce={class:"flex flex-col gap-1 md:col-span-2"},De={class:"flex flex-col gap-1 md:col-span-2"},je={class:"flex flex-col gap-1 md:col-span-2"},Be={class:"flex flex-col gap-1 md:col-span-2"},Fe={class:"flex flex-col gap-1 md:col-span-2"},Me={class:"relative flex flex-col gap-1 md:col-span-2"},Te={class:"absolute w-full -bottom-12 right-0 flex justify-between items-center gap-3"},ze={class:"w-10 aspect-square overflow-hidden rounded-full bg-neutral-200 dark:bg-neutral-800"},Pe={class:"md:col-span-6 px-2 py-2 mt-10 rounded-md border border-neutral-200 dark:border-neutral-800"},Ee={class:"flex items-center gap-2 justify-between"},Ne={class:"flex items-center justify-center"},Re={class:"mt-2 grid gap-2 grid-cols-2"},Ae={class:"mt-4 grid gap-2"},Ge={class:"text-sm"},He={class:"font-semibold"},qe={class:"flex items-center gap-2"},he=["href"],nl=ae({__name:"Book",async setup(Oe){var I;let f,w;const F=ue(),b=ne(),v=(I=F.params.id)==null?void 0:I.toString(),c=m(!1),{data:V,error:U,execute:M}=v?([f,w]=ie(()=>y(`books/${v}`).json()),f=await f,w(),f):{data:null,error:null},l=m(de((V==null?void 0:V.value)??{})),T=m(l.value.coverImage??"");re(()=>l.value.title,a=>{a&&(l.value.slug=ge(a))},{immediate:!0});const x=m(!1),$=m();async function z(){ce(x,$);const{data:a,error:e}=v?await y(`books/${v}`).put({data:l.value}).json():await y("books").post({data:l.value}).json();xe(x,$,e),a.value&&(l.value=a.value,c.value=!1,b.add({severity:"success",summary:"Saved",life:3e3})),e.value&&b.add({severity:"error",summary:"Error",detail:e.value.message,life:6e3})}const P=me(()=>!l.value.title||!l.value.slug||!l.value.author||!l.value.description||!l.value.howToGet||!l.value.status||!l.value.coverImage||l.value.featured===void 0||l.value.featured===null),n=m({label:"",link:""}),E=()=>{var a;if(n.value.label&&n.value.link){if((a=l.value.buyLinks)==null?void 0:a.find(u=>u.label===n.value.label||u.link===n.value.link)){b.add({severity:"warn",summary:"Duplicate link",life:5e3});return}l.value.buyLinks=[...l.value.buyLinks||[],n.value],n.value={label:"",link:""}}},N=a=>{var u;const e=a>0?1:void 0;l.value.buyLinks=(u=l.value.buyLinks)==null?void 0:u.splice(a,e)};function R(a){l.value&&(l.value.coverImage=a.url,c.value=!0)}function A(){l.value&&(l.value.coverImage=T.value,c.value=!1)}return(a,e)=>{const u=pe,G=ee,H=oe,i=se,L=te,S=le,q=Z,C=Y,h=X,O=W,J=Q;return r(),p(J,{header:l.value.title??"Book"},{actions:D(()=>[t("div",be,[o(u,{onClick:z,loading:x.value,label:"Save",disabled:x.value||P.value,icon:"pi pi-save"},null,8,["loading","disabled"]),l.value.id?(r(),p(G,{key:0,onDone:e[0]||(e[0]=k=>a.$router.push({name:"books"})),id:l.value.id,route:"books"},null,8,["id"])):g("",!0)])]),default:D(()=>{var k;return[t("div",null,[_(U)?(r(),p(H,{key:0,error:_(U),"should-retry":"",onRetry:_(M)},null,8,["error","onRetry"])):g("",!0),t("div",null,[t("div",Ve,[t("div",ke,[e[17]||(e[17]=t("label",{class:"text-sm font-medium"},[d(" Title "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(i,{modelValue:l.value.title,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.title=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",ye,[e[18]||(e[18]=t("label",{class:"text-sm font-medium"},[d(" Slug "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(i,{modelValue:l.value.slug,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.slug=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",_e,[e[19]||(e[19]=t("label",{class:"text-sm font-medium"},"Subtitle",-1)),o(i,{modelValue:l.value.subtitle,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.subtitle=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",we,[e[20]||(e[20]=t("label",{class:"text-sm font-medium"},[d(" Author "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(i,{modelValue:l.value.author,"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.author=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",Ue,[e[21]||(e[21]=t("label",{class:"text-sm font-medium"},[d(" Featured "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(L,{modelValue:l.value.featured,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.featured=s),options:[!0,!1],fluid:""},null,8,["modelValue"])]),t("div",$e,[e[22]||(e[22]=t("label",{class:"text-sm font-medium"},[d(" Status "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(L,{modelValue:l.value.status,"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.status=s),options:["DRAFT","PUBLISHED","ARCHIVED"],fluid:""},null,8,["modelValue"])]),t("div",Ie,[e[23]||(e[23]=t("label",{class:"text-sm font-medium"},[d(" Description "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(S,{modelValue:l.value.description,"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.description=s),modelModifiers:{trim:!0},fluid:"",class:"resize-none h-full"},null,8,["modelValue"])]),t("div",Le,[e[24]||(e[24]=t("label",{class:"text-sm font-medium"},[d(" How to get the book "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(S,{modelValue:l.value.howToGet,"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.howToGet=s),modelModifiers:{trim:!0},fluid:"",class:"resize-none h-full"},null,8,["modelValue"])]),t("div",Se,[e[25]||(e[25]=t("label",{class:"text-sm font-medium"}," Genre ",-1)),o(i,{modelValue:l.value.genre,"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.genre=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",Ce,[e[26]||(e[26]=t("label",{class:"text-sm font-medium"}," Language ",-1)),o(i,{modelValue:l.value.language,"onUpdate:modelValue":e[10]||(e[10]=s=>l.value.language=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",De,[e[27]||(e[27]=t("label",{class:"text-sm font-medium"}," Publication Date ",-1)),o(q,{modelValue:l.value.publicationDate,"onUpdate:modelValue":e[11]||(e[11]=s=>l.value.publicationDate=s),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),t("div",je,[e[28]||(e[28]=t("label",{class:"text-sm font-medium"}," Pages ",-1)),o(C,{modelValue:l.value.pages,"onUpdate:modelValue":e[12]||(e[12]=s=>l.value.pages=s),"integer-only":"",fluid:""},null,8,["modelValue"])]),t("div",Be,[e[29]||(e[29]=t("label",{class:"text-sm font-medium"}," Price (if free, leave this blank)",-1)),o(C,{modelValue:l.value.price,"onUpdate:modelValue":e[13]||(e[13]=s=>l.value.price=s),"max-fraction-digits":2,fluid:""},null,8,["modelValue"])]),t("div",Fe,[e[30]||(e[30]=t("label",{class:"text-sm font-medium"}," Currency ",-1)),o(i,{modelValue:l.value.currency,"onUpdate:modelValue":e[14]||(e[14]=s=>l.value.currency=s),modelModifiers:{trim:!0},type:"text",fluid:""},null,8,["modelValue"])]),t("div",Me,[e[31]||(e[31]=t("label",{class:"text-sm font-medium"},[d(" Cover Image "),t("span",{class:"text-red-500 font-medium"},"*")],-1)),o(h,{onSelect:R}),t("div",Te,[t("div",ze,[(k=l.value)!=null&&k.coverImage?(r(),p(O,{key:0,src:l.value.coverImage,preview:"",class:"w-full h-full","image-class":"w-full h-full object-cover"},null,8,["src"])):g("",!0)]),c.value?(r(),p(u,{key:0,onClick:A,label:"File selected",size:"small",severity:"danger",icon:"pi pi-times-circle",class:"py-1"})):g("",!0)])]),t("div",Pe,[t("div",Ee,[e[32]||(e[32]=t("label",{class:"text-sm font-medium"}," Buy Links ",-1)),t("div",Ne,[o(u,{onClick:E,disabled:!n.value.label||!n.value.link,size:"small",icon:"pi pi-plus",rounded:""},null,8,["disabled"])])]),t("div",Re,[t("div",null,[o(i,{modelValue:n.value.label,"onUpdate:modelValue":e[15]||(e[15]=s=>n.value.label=s),placeholder:"label e.g. Selar",size:"small",fluid:""},null,8,["modelValue"])]),t("div",null,[o(i,{modelValue:n.value.link,"onUpdate:modelValue":e[16]||(e[16]=s=>n.value.link=s),placeholder:"href e.g. www.example.com",size:"small",fluid:""},null,8,["modelValue"])])]),t("div",Ae,[(r(!0),j(ve,null,fe(l.value.buyLinks,(s,K)=>(r(),j("div",{key:s.link,class:"flex items-center gap-2 justify-between flex-wrap border border-neutral-200 dark:border-neutral-800 rounded-md p-2"},[t("div",Ge,[t("p",He,B(s.label),1),t("div",qe,[t("p",null,B(s.link),1),t("a",{href:s.link,target:"_blank",rel:"noopener noreferrer"},e[33]||(e[33]=[t("span",{class:"pi pi-external-link text-blue-800 hover:underline",style:{"font-weight":"600","font-size":"0.8rem"}},null,-1)]),8,he)])]),o(u,{onClick:Je=>N(K),icon:"pi pi-trash",rounded:"",text:"",severity:"danger"},null,8,["onClick"])]))),128))])])])])])]}),_:1},8,["header"])}}});export{nl as default};

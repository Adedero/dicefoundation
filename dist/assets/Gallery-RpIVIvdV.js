import{_ as z}from"./VPage.vue_vue_type_script_setup_true_lang-C4NydXBT.js";import{d as x,u as N,r as h,aE as V,b as p,G as B,j as i,s as D,o as r,m as I,n as U,a as n,aF as G,w as k,k as C,h as P,c as F,l as _,F as S,e as q,t as A}from"./index-Cjbmz-ZE.js";import{$ as j,_ as E}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-B4fsL62Q.js";import{s as M}from"./index-BEZZY-jP.js";import{_ as R}from"./FileUploader.vue_vue_type_script_setup_true_lang-DWG_6tCL.js";import"./index-jtX0e_pZ.js";const L=x({__name:"ImageDeleter",props:{id:{}},emits:["delete"],setup($,{emit:c}){const f=N(),e=c,t=h(!1),o=h();async function l(){I(t,o);const{data:m,error:a}=await j(`gallery/${$.id}`).delete().json();U(t,o,a),a.value&&f.add({severity:"error",summary:"Error",detail:a.value.message,life:3e3}),m.value&&e("delete",$.id)}const v=V(),u=()=>{v.require({header:"Delete file",message:"Are you sure you want to delete this file?",rejectProps:{severity:"secondary",icon:"pi pi-times",label:"Cancel"},acceptProps:{severity:"danger",icon:"pi pi-trash",label:"Delete"},accept:()=>{l()}})};return(m,a)=>{const s=D;return r(),p("div",{onClick:u,class:"cursor-pointer w-full"},[B(m.$slots,"default",{},()=>[i(s,{label:"Delete",icon:"pi pi-trash",severity:"danger"})])])}}}),T={key:0,class:"mb-4"},H={key:1,class:"flex items-center justify-center mb-5"},J={class:"w-full aspect-square rounded-md overflow-hidden bg-zinc-200 dark:bg-zinc-600"},K=["src"],O=x({__name:"ImageCreator",emits:["create"],setup($,{emit:c}){const f=c,e=h(!1),t=h(),o=h(!1),l=h();async function v(a){const s=a[0];delete s.dataUrl,I(o,l);const g=new FormData;g.append("file",s);const{data:y,error:w}=await j("gallery").post(g).json();U(o,l,w),y.value&&(t.value=y.value,f("create",t.value),e.value=!1)}function u(a){t.value={name:a[0].name,url:a[0].dataUrl??""}}function m(){t.value=void 0,e.value=!1,l.value=void 0,o.value=!1}return(a,s)=>{const g=D,y=E,w=R,d=G;return r(),p("div",null,[n("div",{onClick:s[0]||(s[0]=b=>e.value=!0),class:"cursor-pointer"},[B(a.$slots,"default",{},()=>[i(g,{label:"New",icon:"pi pi-plus"})])]),i(d,{visible:e.value,"onUpdate:visible":s[1]||(s[1]=b=>e.value=b),modal:"",header:"Upload Image",class:"w-80"},{default:k(()=>[l.value?(r(),p("div",T,[i(y,{error:l.value},null,8,["error"])])):C("",!0),t.value&&t.value.url?(r(),p("div",H,[n("div",J,[n("img",{src:t.value.url,class:"w-full h-full object-cover"},null,8,K)])])):C("",!0),n("div",null,[i(w,{loading:o.value,onCancel:m,onSelect:u,onUpload:v,"max-file-size":1024*1024*10,accept:"image/*"},null,8,["loading"])])]),_:1},8,["visible"])])}}}),Q={class:"flex justify-end"},W={key:1,class:"grid gap-5 grid-cols-[repeat(auto-fill,minmax(180px,1fr))]"},X={class:"w-full h-54 bg-neutral-200 dark:bg-neutral-800 rounded-md overflow-hidden"},Y={class:"mt-2 w-full grid items-center gap-1 grid-cols-6"},Z={class:"col-span-5 truncate"},re=x({__name:"Gallery",async setup($){let c,f;const{data:e,error:t,execute:o}=([c,f]=P(()=>j("gallery").json()),c=await c,f(),c);function l(v){e.value&&(e.value=e.value.filter(u=>u.id!==v))}return(v,u)=>{const m=O,a=E,s=M,g=D,y=L,w=z;return r(),F(w,{header:"Gallery"},{actions:k(()=>[n("div",Q,[i(m,{onCreate:u[0]||(u[0]=d=>_(e)&&(e.value=[..._(e),d]))})])]),default:k(()=>[n("div",null,[_(t)?(r(),F(a,{key:0,error:_(t),"should-retry":"",onRetry:_(o)},null,8,["error","onRetry"])):_(e)?(r(),p("div",W,[(r(!0),p(S,null,q(_(e),(d,b)=>(r(),p("div",{key:d.id},[n("div",X,[i(s,{src:d.url,preview:"",class:"h-full w-full","image-class":"w-full h-full object-cover"},null,8,["src"])]),n("div",Y,[n("p",Z,A(d.name||`Image ${b+1}`),1),i(y,{id:d.id,onDelete:l},{default:k(()=>[i(g,{icon:"pi pi-trash",size:"small",severity:"danger",text:""})]),_:2},1032,["id"])])]))),128))])):C("",!0)])]),_:1})}}});export{re as default};
